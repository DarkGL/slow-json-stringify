!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(e.slowJsonStringify={})}(this,function(exports){var _find=function(path){for(var length=path.length,str="obj",i=0;i<length;i++)str=str.replace(/^/,"("),str+=" || {})."+path[i];return eval("((obj) => "+str+")")},_makeArraySerializer=function(e){return e instanceof Function?function(r){for(var n="",t=r.length,a=0;a<t-1;a++)n+=e(r[a])+",";return"["+(n+=e(r[t-1]))+"]"}:function(e){return JSON.stringify(e)}},TYPES=["number","string","boolean","array","null"],attr=function(e,r){if(!TYPES.includes(e))throw new Error('Expected one of: "number", "string", "boolean", "null". received "'+e+'" instead');return"array"===e?_makeArraySerializer(r):e},defaultRegex=new RegExp('\\n|\\r|\\t|\\"|\\\\',"gm"),escape=function(e){return void 0===e&&(e=defaultRegex),function(r){return r.replace(e,function(e){return"\\"+e})}},_makeQueue=function(e,r){var n=[],t=new Set(["number__sjs","string__sjs","boolean__sjs","array__sjs"]);return function e(a,s){if(void 0===s&&(s=[]),!t.has(a))return Object.keys(a).map(function(r){return e(a[r],s.concat([r]))});var i=Array.from(s),o=_find(i),u=o(r);n.push({isArray:u instanceof Function,serializer:u,find:o,name:i[i.length-1]})}(e),n},_makeChunks=function(e,r){return e.replace(/"(string__sjs|number__sjs|boolean__sjs|array__sjs)"|\[(.*?)\]/gm,function(e){return'"string__sjs"'===e?'"__par__"':"__par__"}).split("__par__").map(function(e,n,t){var a='("'+(r[n]||{}).name+'":("?))$',s="(,?)"+a,i=/^("}|})/.test(t[n+1]||""),o=new RegExp(i?s:a),u=/^(\"\,|\,|\")/;return{flag:!1,pure:e,prevUndef:e.replace(u,""),isUndef:e.replace(o,""),bothUndef:e.replace(u,"").replace(o,"")}})},select=function(e){return function(r,n){var t=e[n];return void 0!==r?t.flag?t.prevUndef+r:t.pure+r:(e[n+1].flag=!0,t.flag?t.bothUndef:t.isUndef)}},sjs=function(e){var r=JSON.stringify(e,function(e,r){return"object"==typeof r?r:r instanceof Function?"array__sjs":r+"__sjs"}),n=JSON.parse(r),t=_makeQueue(n,e),a=t.length,s=_makeChunks(r,t),i=select(s);return function(e){for(var r="",n=0;n!==a;){var o=t[n],u=o.serializer,f=o.isArray,c=(0,o.find)(e),_=f?u(c):c;r+=i(_,n),n+=1}var p=s[s.length-1];return r+(p.flag?p.prevUndef:p.pure)}};exports.sjs=sjs,exports.attr=attr,exports.escape=escape});
//# sourceMappingURL=sjs.umd.js.map
