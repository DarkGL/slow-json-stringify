!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(e.slowJsonStringify={})}(this,function(exports){var _find=function(path){for(var length=path.length,str="obj",i=0;i<length;i++)str=str.replace(/^/,"("),str+=" || {})."+path[i];return eval("((obj) => "+str+")")},_makeArr=function(e,r){if("array-simple"===r)return JSON.stringify(e);for(var n="",t=e.length,a=0;a<t-1;a++)n+=r(e[a])+",";return"["+(n+=r(e[t-1]))+"]"},_validator=function(e){var r=new Set(["number","string","boolean","array-simple","function"]);if(Array.isArray(e)){if(r.has(e[0])||r.has(typeof e[0]))return;throw new Error('Expected either "array-simple" or a function. received '+e)}if("function"!=typeof e&&!r.has(e))throw new Error('Expected one of: "number", "string", "boolean". received '+e)},defaultRegex=new RegExp('\\n|\\r|\\t|\\"|\\\\',"gm"),escape=function(e){return void 0===e&&(e=defaultRegex),function(r){return r.replace(e,function(e){return"\\"+e})}},_prepareString=function(e){return JSON.stringify(e,function(e,r){var n=Array.isArray(r);return"object"!=typeof r||n?(_validator(r),n?r:"function"==typeof r?r:r+"__sjs"):r})},_makeQueue=function(e,r){var n=[],t=new Set(["number__sjs","string__sjs","boolean__sjs"]);return function e(a,i){void 0===i&&(i=[]);var o=Array.isArray(a);if(!t.has(a)&&!o)return Object.keys(a).map(function(r){return e(a[r],i.concat([r]))});var s=Array.from(i),f=_find(s);n.push({isArray:o,method:o&&f(r)[0],find:f,name:s[s.length-1]})}(e),n},_makeChunks=function(e,r){return e.replace(/"(string__sjs|number__sjs|boolean__sjs)"|\[(.*?)\]/gm,function(e){return'"string__sjs"'===e?'"__par__"':"__par__"}).split("__par__").map(function(e,n){var t=new RegExp('"'+(r[n]||{}).name+'":("?)$'),a=/^(\"\,|\,|\")/;return{flag:!1,pure:e,prevUndef:e.replace(a,""),isUndef:e.replace(t,""),bothUndef:e.replace(a,"").replace(t,"")}})},select=function(e){return function(r,n){var t=e[n];return void 0!==r?t.flag?t.prevUndef+r:t.pure+r:(e[n+1].flag=!0,t.flag?t.bothUndef:t.isUndef)}},sjs=function(e){var r=_prepareString(e),n=JSON.parse(r),t=_makeQueue(n,e),a=t.length,i=_makeChunks(r,t),o=select(i);return function(e){for(var r="",n=0;n!==a;){var s=t[n],f=s.method,u=s.isArray,p=(0,s.find)(e),c=u?_makeArr(p,f):p;r+=o(c,n),n+=1}var _=i[i.length-1];return r+(_.flag?_.prevUndef:_.pure)}};exports.sjs=sjs,exports.escape=escape});
//# sourceMappingURL=sjs.umd.js.map
