!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(r.slowJsonStringify={})}(this,function(r){var e=function(r,n){for(var t in r){if(t===n)return[t];if(r[t]&&"object"==typeof r[t]){var u=e(r[t],n);if(u)return u.unshift(t),u}}},n=function(r,e){return e.reduce(function(r,e){return r&&r[e]},r)},t=function(r,e){if("array-simple"===e)return JSON.stringify(r);for(var n="",t=0,u=r;t<u.length;t+=1)n+=e(u[t])+",";return"["+n.substr(0,n.length-1)+"]"};r.sjs=function(r){var u=function(r){var n,t,u,i,a={},o=new Map,f="",s=JSON.stringify(r,function(n,t){var u=Array.isArray(t);return("object"!=typeof t||u)&&(u&&o.set(n,t[0]),function(r){var e=new Set(["number","string","boolean","undefined","array-simple","function"]);if(Array.isArray(r)){if(e.has(r[0])||e.has(typeof r[0]))return;throw new Error('Expected either "array-simple" or a function. received '+r)}if("function"!=typeof r&&!e.has(r))throw new Error('Expected one of: "number", "string", "boolean", "undefined". received '+r)}(t),a[n]=e(r,n),f+='"'+n+'"|'),t});return{map:a,arrais:o,props:f,str:s,queue:(n=r,t=["string","number","boolean","array"],u=[],i=new Set(t),function r(e,n){void 0===n&&(n=[]);var t=Array.isArray(e);if(!i.has(e)&&!t)return Object.keys(e).map(function(t){return r(e[t],n.concat([t]))});u.push({isArray:t,method:t&&e[0],path:[n].flat()})}(n),u)}}(r),i=u.queue,a=function(r,e){var n=[],t=r.replace(e,function(r){switch(r){case'"string"':case'"undefined"':return'"__par__"';case'"number"':case'"boolean"':case'["array-simple"]':case"[null]":return"__par__";default:var e=r.match(/(?<=\").+?(?=\")/)[0];return n.push(e),r}}).split("__par__");return{queue:n,chunks:t}}(u.str,new RegExp(u.props+'"(string|number|boolean|undef)"|\\[(.*?)\\]',"gm")).chunks,o=a[a.length-1],f=function(r){return function(e,n){if(void 0!==e)return e;var t=r[n];return 34===t.charCodeAt(t.length-1)?e:'"'+e+'"'}}(a),s=i.length;return function(r){for(var e="",u=0;u!==s;){var c=i[u],p=c.method,d=c.isArray,h=n(r,c.path),y=d?t(h,p):h;e+=a[u]+f(y,u),u+=1}return e+o}},r.escape=function(r){var e=r||new RegExp('\\n|\\r|\\t|\\"|\\\\',"gm");return function(r){return r.replace(e,function(r){return"\\"+r})}}});
//# sourceMappingURL=sjs.umd.js.map
