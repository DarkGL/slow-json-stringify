var _prepare=function(r){var e=JSON.stringify(r,function(r,e){return"object"==typeof e?e:e instanceof Function?"array__sjs":e+"__sjs"});return{preparedString:e,preparedSchema:JSON.parse(e)}},_find=function(path){for(var length=path.length,str="obj",i=0;i<length;i++)str=str.replace(/^/,"("),str+=" || {})."+path[i];return eval("((obj) => "+str+")")},_makeArraySerializer=function(r){return r instanceof Function?function(e){for(var n="",t=e.length,a=0;a<t-1;a++)n+=r(e[a])+",";return"["+(n+=r(e[t-1]))+"]"}:function(r){return JSON.stringify(r)}},TYPES=["number","string","boolean","array","null"],attr=function(r,e){if(!TYPES.includes(r))throw new Error('Expected one of: "number", "string", "boolean", "null". received "'+r+'" instead');return"array"===r?_makeArraySerializer(e):r},defaultRegex=new RegExp('\\n|\\r|\\t|\\"|\\\\',"gm"),escape=function(r){return void 0===r&&(r=defaultRegex),function(e){return e.replace(r,function(r){return"\\"+r})}},_makeQueue=function(r,e){var n=[],t=new Set(["number__sjs","string__sjs","boolean__sjs","array__sjs"]);return function r(a,s){if(void 0===s&&(s=[]),!t.has(a))return Object.keys(a).map(function(e){return r(a[e],s.concat([e]))});var i=Array.from(s),u=_find(i),o=u(e);n.push({isArray:o instanceof Function,serializer:o,find:u,name:i[i.length-1]})}(r),n},_makeChunks=function(r,e){return r.replace(/"(string__sjs|number__sjs|boolean__sjs|array__sjs)"|\[(.*?)\]/gm,function(r){return'"string__sjs"'===r?'"__par__"':"__par__"}).split("__par__").map(function(r,n,t){var a='("'+(e[n]||{}).name+'":("?))$',s="(,?)"+a,i=/^("}|})/.test(t[n+1]||""),u=new RegExp(i?s:a),o=/^(\"\,|\,|\")/;return{flag:!1,pure:r,prevUndef:r.replace(o,""),isUndef:r.replace(u,""),bothUndef:r.replace(o,"").replace(u,"")}})},_select=function(r){return function(e,n){var t=r[n];return void 0!==e?t.flag?t.prevUndef+e:t.pure+e:(r[n+1].flag=!0,t.flag?t.bothUndef:t.isUndef)}},sjs=function(r){var e=_prepare(r),n=e.preparedString,t=_makeQueue(e.preparedSchema,r),a=_makeChunks(n,t),s=_select(a),i=t.length;return function(r){for(var e="",n=0;n!==i;){var u=t[n],o=u.serializer,f=u.isArray,c=(0,u.find)(r),p=f?o(c):c;e+=s(p,n),n+=1}var _=a[a.length-1];return e+(_.flag?_.prevUndef:_.pure)}};exports.sjs=sjs,exports.attr=attr,exports.escape=escape;
//# sourceMappingURL=sjs.js.map
